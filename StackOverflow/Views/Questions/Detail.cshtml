@{
  ViewBag.Title = "Questions";
}

@section SidebarLeft{
  @Html.Partial("Partials/_SidebarLeft")
}

@section SectionRight
{
  @Html.Partial("Partials/_SectionRight")
}

<style>
  /* ========== CUSTOM VARIABLES ========== */
  :root {
    --color-primary: #F48023;
    --color-primary-2: #F48023;
    --color-sub-primary: #FCF4EC;

    /* Neutral colors */
    /*--bs-body-bg: #f8f9fa;*/
    /*--bs-body-color: #2d2d2d;*/
    --text-muted: #6c757d;
    --border-color: #dee2e6;
    --success-color: #48C774;
  }

  /* ========== VOTE BUTTONS ========== */
  .btn-vote {
    border: none;
    background: transparent;
    color: #9199a1;
    padding: 0;
    cursor: pointer;
    transition: color 0.2s;
  }

  .btn-vote:hover {
    color: var(--color-primary);
    background: transparent;
  }

  .btn-vote:active,
  .btn-vote:focus {
    box-shadow: none;
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
  }

  .vote-col {
    min-width: 48px;
  }

  .vote-count {
    color: var(--bs-body-color);
    font-size: 1.25rem;
    user-select: none;
  }

  .btn-bookmark,
  .btn-accepted {
    border: none;
    background: transparent;
    padding: 0;
    cursor: pointer;
    color: #9199a1;
  }

  .btn-bookmark:hover {
    color: var(--color-primary);
  }

  /* ========== TAG BADGES ========== */
  .tag-badge {
    background-color: var(--color-sub-primary);
    color: var(--color-primary);
    border: 1px solid #f1d4bb;
    text-decoration: none;
    padding: 6px 12px;
    border-radius: 4px;
    font-size: 0.875rem;
    transition: all 0.2s;
  }

  .tag-badge:hover {
    background-color: #f1d4bb;
    color: var(--color-primary-2);
  }

  /* ========== ACCEPTED ANSWER ========== */
  .answer-accepted {
    background: linear-gradient(to right, #f0fff4 0%, white 3%);
  }

  /* ========== PRIMARY BUTTON OVERRIDE ========== */
  .btn-primary-custom {
    background-color: var(--color-primary);
    border-color: var(--color-primary);
    color: white;
    padding: 0.5rem 1.25rem;
    font-weight: 500;
    transition: background-color 0.2s, box-shadow 0.2s;
  }

  .btn-primary-custom:hover {
    background-color: #dc7014;
    border-color: #dc7014;
  }

  .btn-primary-custom:focus {
    box-shadow: 0 0 0 0.25rem rgba(244, 128, 35, 0.25);
  }

  /* ========== CODE BLOCKS ========== */
  pre {
    background-color: #f6f8fa;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    padding: 16px;
    overflow-x: auto;
    font-size: 0.875rem;
  }

  code {
    background-color: #f6f8fa;
    color: #24292f;
    padding: 0.2em 0.4em;
    border-radius: 3px;
    font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, monospace;
  }

  pre code {
    background: transparent;
    padding: 0;
  }

  /* ========== FORM ENHANCEMENTS ========== */
  .form-control:focus {
    border-color: var(--color-primary);
    box-shadow: 0 0 0 0.25rem rgba(244, 128, 35, 0.15);
  }

  .form-label {
    color: var(--bs-body-color);
    margin-bottom: 0.5rem;
  }

  /* ========== CARD IMPROVEMENTS ========== */
  .card {
    border: 1px solid var(--border-color);
    /*border-radius: 8px;*/
  }

  .answer-meta .btn-link {
    text-decoration: none;
    padding: 0.25rem 0.5rem;
  }

  .answer-meta .btn-link:hover {
    text-decoration: underline;
  }

  /* ========== RESPONSIVE ========== */


  .vote-count {
    font-size: 1rem;
  }

  .btn-vote svg {
    width: 20px;
    height: 20px;
  }

  .card {
    border: none;
  }

</style>  
<div class="col-12 col-md-9 col-lg-7 px-2">

  <div class="my-4">
    <!-- Question Section -->
    <article class="card border-bottom rounded-0">
      <div class="card-body">
        <div class="border-bottom mb-3">
          <div class="mb-3">
            <h1 class="h3 mb-2">Làm sao thiết kế trang chi tiết Q&A trong ASP.NET MVC?</h1>
            <div class="text-muted small">
              <span>đã hỏi <time>2 giờ trước</time></span>
              <span class="mx-2">•</span>
              <span>bởi <a href="#" class="link-primary">user123</a></span>
              <span class="mx-2">•</span>
              <span>xem 145 lần</span>
            </div>
          </div>
        </div>

            <div class="question-body mb-3">
              <p class="mb-3">Tôi đang xây dựng một trang hỏi đáp với ASP.NET MVC, muốn có bố cục hiển thị câu hỏi chi
                tiết, danh sách trả lời và form nhập câu trả lời. Có cách nào tối ưu cho việc phân trang và cache
                không?</p>

              <pre class="bg-light border p-3"><code>// QuestionController.cs
public ActionResult Details(int id) {
    var question = _db.Questions.Include(q => q.Answers)
                                .FirstOrDefault(q => q.Id == id);
    return View(question);
}</code></pre>

              <p>Mọi người có thể gợi ý pattern nào tốt cho việc load câu trả lời không?</p>
            </div>

            <div class="d-flex flex-wrap gap-2 mb-3">
              <a href="#" class="badge tag-badge">asp.net-mvc</a>
              <a href="#" class="badge tag-badge">sql-server</a>
              <a href="#" class="badge tag-badge">entity-framework</a>
              <a href="#" class="badge tag-badge">performance</a>
            </div>

          </div>
    </article>
    <!-- Answer Form Section -->
    <section class="card mb-3">
      <div class="card-body">
        <h2 class="h4 mb-3">Thêm câu trả lời của bạn</h2>
        <form action="/Question/PostAnswer" method="post">
          <input type="hidden" name="QuestionId" value="123"/>
          <div class="mb-3">
            <label for="answerBody" class="form-label fw-semibold">Nội dung trả lời</label>
            <textarea
              class="form-control"
              id="answerBody"
              name="Body"
              rows="8"
              required
              aria-describedby="answerHelp"
              placeholder="Viết câu trả lời chi tiết, có ví dụ code nếu cần..."></textarea>
            <div id="answerHelp" class="form-text">
              Hỗ trợ Markdown cơ bản: **in đậm**, *in nghiêng*, `code inline`, và khối code với backtick 3 lần.
            </div>
          </div>

          <div class="d-flex gap-2">
            <button type="submit" class="btn btn-primary-custom">Gửi câu trả lời</button>
            <button type="button" class="btn btn-outline-secondary">Xem trước</button>
          </div>
        </form>
      </div>
    </section>
    <!-- Answers Section -->
    <section class="mb-4">
      <h2 class="h4 mb-3">3 câu trả lời</h2>

      <!-- Answer 1 - Accepted -->
      <article class="card mb-3 shadow-sm answer-accepted" style="border-left: 4px solid #48C774;: ">
        <div class="card-body">
            <!-- Answer Content -->
              <div class="answer-body mb-3">
                <p>Dùng Repository Pattern với Unit of Work để tách logic truy vấn. Triển khai lazy loading cho câu trả
                  lời và cache với Output Cache hoặc Redis:</p>

                <pre class="bg-light border rounded p-3"><code>[OutputCache(Duration = 300, VaryByParam = "id")]
public ActionResult Details(int id) {
    var question = _questionRepo.GetById(id);
    return View(question);
}</code></pre>
                <p>Phân trang câu trả lời khi số lượng lớn (>20) để giảm tải trang ban đầu.</p>
              </div>

              <div class="answer-meta d-flex justify-content-between align-items-center">
                <div class="text-muted small">
                  <span>trả lời bởi <a href="#" class="link-primary">devA</a></span>
                  <span class="ms-2">1 giờ trước</span>
                </div>
              </div>
        </div>
      </article>
    </section>
  </div>
</div>